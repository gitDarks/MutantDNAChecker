"use strict";function cov_22315r6cy8(){var path="/Users/drodr25/Desktop/MutantDNAChecker/src/modules/dna-checker/controllers/dna-checker.controller.ts";var hash="507b7daf6346e04d1f522ae24becfd8ae9bda481";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/drodr25/Desktop/MutantDNAChecker/src/modules/dna-checker/controllers/dna-checker.controller.ts",statementMap:{"0":{start:{line:2,column:16},end:{line:10,column:1}},"1":{start:{line:3,column:28},end:{line:3,column:110}},"2":{start:{line:3,column:91},end:{line:3,column:106}},"3":{start:{line:4,column:4},end:{line:9,column:7}},"4":{start:{line:5,column:36},end:{line:5,column:97}},"5":{start:{line:5,column:42},end:{line:5,column:70}},"6":{start:{line:5,column:85},end:{line:5,column:95}},"7":{start:{line:6,column:35},end:{line:6,column:100}},"8":{start:{line:6,column:41},end:{line:6,column:73}},"9":{start:{line:6,column:88},end:{line:6,column:98}},"10":{start:{line:7,column:32},end:{line:7,column:116}},"11":{start:{line:8,column:8},end:{line:8,column:78}},"12":{start:{line:11,column:0},end:{line:11,column:62}},"13":{start:{line:12,column:0},end:{line:12,column:28}},"14":{start:{line:13,column:27},end:{line:13,column:64}},"15":{start:{line:14,column:18},end:{line:14,column:59}},"16":{start:{line:15,column:32},end:{line:15,column:107}},"17":{start:{line:16,column:37},end:{line:16,column:117}},"18":{start:{line:17,column:31},end:{line:17,column:105}},"19":{start:{line:18,column:36},end:{line:18,column:115}},"20":{start:{line:19,column:26},end:{line:19,column:72}},"21":{start:{line:20,column:31},end:{line:20,column:74}},"22":{start:{line:21,column:21},end:{line:21,column:65}},"23":{start:{line:24,column:8},end:{line:24,column:32}},"24":{start:{line:25,column:8},end:{line:25,column:33}},"25":{start:{line:26,column:8},end:{line:26,column:82}},"26":{start:{line:29,column:8},end:{line:72,column:11}},"27":{start:{line:30,column:25},end:{line:30,column:35}},"28":{start:{line:31,column:29},end:{line:31,column:49}},"29":{start:{line:33,column:12},end:{line:33,column:35}},"30":{start:{line:35,column:12},end:{line:35,column:61}},"31":{start:{line:36,column:12},end:{line:65,column:13}},"32":{start:{line:36,column:25},end:{line:36,column:26}},"33":{start:{line:37,column:16},end:{line:64,column:17}},"34":{start:{line:37,column:29},end:{line:37,column:30}},"35":{start:{line:40,column:20},end:{line:40,column:96}},"36":{start:{line:41,column:20},end:{line:43,column:47}},"37":{start:{line:47,column:20},end:{line:47,column:105}},"38":{start:{line:48,column:20},end:{line:50,column:47}},"39":{start:{line:53,column:20},end:{line:53,column:94}},"40":{start:{line:54,column:20},end:{line:56,column:47}},"41":{start:{line:60,column:20},end:{line:60,column:103}},"42":{start:{line:61,column:20},end:{line:63,column:47}},"43":{start:{line:68,column:32},end:{line:68,column:72}},"44":{start:{line:69,column:28},end:{line:69,column:48}},"45":{start:{line:70,column:12},end:{line:70,column:68}},"46":{start:{line:71,column:12},end:{line:71,column:31}},"47":{start:{line:75,column:8},end:{line:75,column:41}},"48":{start:{line:76,column:19},end:{line:76,column:21}},"49":{start:{line:77,column:8},end:{line:84,column:11}},"50":{start:{line:78,column:12},end:{line:78,column:35}},"51":{start:{line:79,column:24},end:{line:79,column:35}},"52":{start:{line:80,column:12},end:{line:82,column:15}},"53":{start:{line:81,column:16},end:{line:81,column:72}},"54":{start:{line:83,column:12},end:{line:83,column:41}},"55":{start:{line:87,column:8},end:{line:100,column:11}},"56":{start:{line:88,column:12},end:{line:99,column:13}},"57":{start:{line:89,column:34},end:{line:89,column:76}},"58":{start:{line:90,column:16},end:{line:90,column:41}},"59":{start:{line:91,column:16},end:{line:91,column:52}},"60":{start:{line:92,column:16},end:{line:92,column:73}},"61":{start:{line:93,column:16},end:{line:93,column:66}},"62":{start:{line:96,column:16},end:{line:96,column:58}},"63":{start:{line:97,column:16},end:{line:97,column:66}},"64":{start:{line:98,column:16},end:{line:98,column:35}},"65":{start:{line:103,column:0},end:{line:103,column:32}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:44},end:{line:2,column:45}},loc:{start:{line:2,column:89},end:{line:10,column:1}},line:2},"1":{name:"adopt",decl:{start:{line:3,column:13},end:{line:3,column:18}},loc:{start:{line:3,column:26},end:{line:3,column:112}},line:3},"2":{name:"(anonymous_2)",decl:{start:{line:3,column:70},end:{line:3,column:71}},loc:{start:{line:3,column:89},end:{line:3,column:108}},line:3},"3":{name:"(anonymous_3)",decl:{start:{line:4,column:36},end:{line:4,column:37}},loc:{start:{line:4,column:63},end:{line:9,column:5}},line:4},"4":{name:"fulfilled",decl:{start:{line:5,column:17},end:{line:5,column:26}},loc:{start:{line:5,column:34},end:{line:5,column:99}},line:5},"5":{name:"rejected",decl:{start:{line:6,column:17},end:{line:6,column:25}},loc:{start:{line:6,column:33},end:{line:6,column:102}},line:6},"6":{name:"step",decl:{start:{line:7,column:17},end:{line:7,column:21}},loc:{start:{line:7,column:30},end:{line:7,column:118}},line:7},"7":{name:"(anonymous_7)",decl:{start:{line:23,column:4},end:{line:23,column:5}},loc:{start:{line:23,column:18},end:{line:27,column:5}},line:23},"8":{name:"(anonymous_8)",decl:{start:{line:28,column:4},end:{line:28,column:5}},loc:{start:{line:28,column:18},end:{line:73,column:5}},line:28},"9":{name:"(anonymous_9)",decl:{start:{line:29,column:47},end:{line:29,column:48}},loc:{start:{line:29,column:60},end:{line:72,column:9}},line:29},"10":{name:"(anonymous_10)",decl:{start:{line:74,column:4},end:{line:74,column:5}},loc:{start:{line:74,column:22},end:{line:85,column:5}},line:74},"11":{name:"(anonymous_11)",decl:{start:{line:77,column:20},end:{line:77,column:21}},loc:{start:{line:77,column:34},end:{line:84,column:9}},line:77},"12":{name:"(anonymous_12)",decl:{start:{line:80,column:25},end:{line:80,column:26}},loc:{start:{line:80,column:44},end:{line:82,column:13}},line:80},"13":{name:"(anonymous_13)",decl:{start:{line:86,column:4},end:{line:86,column:5}},loc:{start:{line:86,column:38},end:{line:101,column:5}},line:86},"14":{name:"(anonymous_14)",decl:{start:{line:87,column:47},end:{line:87,column:48}},loc:{start:{line:87,column:60},end:{line:100,column:9}},line:87}},branchMap:{"0":{loc:{start:{line:2,column:16},end:{line:10,column:1}},type:"binary-expr",locations:[{start:{line:2,column:17},end:{line:2,column:21}},{start:{line:2,column:25},end:{line:2,column:39}},{start:{line:2,column:44},end:{line:10,column:1}}],line:2},"1":{loc:{start:{line:3,column:35},end:{line:3,column:109}},type:"cond-expr",locations:[{start:{line:3,column:56},end:{line:3,column:61}},{start:{line:3,column:64},end:{line:3,column:109}}],line:3},"2":{loc:{start:{line:4,column:16},end:{line:4,column:34}},type:"binary-expr",locations:[{start:{line:4,column:16},end:{line:4,column:17}},{start:{line:4,column:22},end:{line:4,column:33}}],line:4},"3":{loc:{start:{line:7,column:32},end:{line:7,column:115}},type:"cond-expr",locations:[{start:{line:7,column:46},end:{line:7,column:67}},{start:{line:7,column:70},end:{line:7,column:115}}],line:7},"4":{loc:{start:{line:8,column:51},end:{line:8,column:67}},type:"binary-expr",locations:[{start:{line:8,column:51},end:{line:8,column:61}},{start:{line:8,column:65},end:{line:8,column:67}}],line:8},"5":{loc:{start:{line:41,column:43},end:{line:43,column:46}},type:"cond-expr",locations:[{start:{line:42,column:26},end:{line:42,column:50}},{start:{line:43,column:26},end:{line:43,column:46}}],line:41},"6":{loc:{start:{line:48,column:43},end:{line:50,column:46}},type:"cond-expr",locations:[{start:{line:49,column:26},end:{line:49,column:50}},{start:{line:50,column:26},end:{line:50,column:46}}],line:48},"7":{loc:{start:{line:54,column:43},end:{line:56,column:46}},type:"cond-expr",locations:[{start:{line:55,column:26},end:{line:55,column:50}},{start:{line:56,column:26},end:{line:56,column:46}}],line:54},"8":{loc:{start:{line:61,column:43},end:{line:63,column:46}},type:"cond-expr",locations:[{start:{line:62,column:26},end:{line:62,column:50}},{start:{line:63,column:26},end:{line:63,column:46}}],line:61},"9":{loc:{start:{line:68,column:32},end:{line:68,column:72}},type:"cond-expr",locations:[{start:{line:68,column:60},end:{line:68,column:64}},{start:{line:68,column:67},end:{line:68,column:72}}],line:68}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},inputSourceMap:{version:3,file:"/Users/drodr25/Desktop/MutantDNAChecker/src/modules/dna-checker/controllers/dna-checker.controller.ts",sources:["/Users/drodr25/Desktop/MutantDNAChecker/src/modules/dna-checker/controllers/dna-checker.controller.ts"],names:[],mappings:"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",sourcesContent:["import { Nucleotide } from \"../models/nucleotide.model\";\nimport { SearchContext } from \"./searching-strategies/context\";\nimport { SearchRightStrategy } from \"./searching-strategies/concrete-strategies/search-right-strategy\";\nimport { SearchRightDownStrategy } from \"./searching-strategies/concrete-strategies/search-rigth-down-strategy\";\nimport { SearchDownStrategy } from \"./searching-strategies/concrete-strategies/search-down-strategy\";\nimport { SearchLeftDownStrategy } from \"./searching-strategies/concrete-strategies/search-left-down-strategy\";\nimport { DNASequencesEntity } from \"../../core/entities/sequence.entity\";\nimport { DnaSequenceService } from \"../services/dna_sequence.service\";\nimport { ConnectionDB } from \"../../core/services/db/db.service\";\n\nexport class DNAChecker {\n  dnaMatrixFull: Nucleotide[][] = [];\n  private sequenceCounter: number = 0;\n  private context: SearchContext;\n\n  private readonly dnaSequenceService: DnaSequenceService;\n\n  constructor() {\n    this.dnaSequenceService = new DnaSequenceService();\n  }\n\n  public async isMutant(dna: string[]): Promise<boolean> {\n    const size = dna.length;\n    const initTime = new Date().valueOf();\n\n    // Mapeamos el array de entrada en un array 2D para hacer las busquedas en profundidad\n    this.mapDnaMatrix(dna);\n\n    // Verificar secuencia de ADN\n    this.context = new SearchContext(size);\n    for (let i = 0; i < size; i++) {\n      for (let j = 0; j < size; j++) {\n        /*Realizar comparaci\xF3n con los nucleotidos de la horizontal a la derecha usando la estrategia de\n        busqueda en profundidad, si encuentra una secuencia aumenta el contador de secuencias*/\n        this.context.setStrategy(new SearchRightStrategy());\n        this.sequenceCounter = this.context.search(i, j, this.dnaMatrixFull)\n          ? this.sequenceCounter + 1\n          : this.sequenceCounter;\n\n        /*Realizar comparaci\xF3n con los nucleotidos de la diagonal derecha hacia abajo usando la\n        estrategia de busqueda en profundidad, si encuentra una secuencia aumenta el contador de\n        secuencias*/\n        this.context.setStrategy(new SearchRightDownStrategy());\n        this.sequenceCounter = this.context.search(i, j, this.dnaMatrixFull)\n          ? this.sequenceCounter + 1\n          : this.sequenceCounter;\n\n        /*Realizar comparaci\xF3n con los nucleotidos de la vertical hacia abajo usando la estrategia de\n        busqueda en profundidad, si encuentra una secuencia aumenta el contador de secuencias*/\n        this.context.setStrategy(new SearchDownStrategy());\n        this.sequenceCounter = this.context.search(i, j, this.dnaMatrixFull)\n          ? this.sequenceCounter + 1\n          : this.sequenceCounter;\n\n        /*Realizar comparaci\xF3n con los nucleotidos de la diagonal izquierda hacia abajo usando la\n        estrategia de busqueda en profundidad, si encuentra una secuencia aumenta el contador de\n        secuencias*/\n        this.context.setStrategy(new SearchLeftDownStrategy());\n        this.sequenceCounter = this.context.search(i, j, this.dnaMatrixFull)\n          ? this.sequenceCounter + 1\n          : this.sequenceCounter;\n      }\n    }\n\n    /*no es necesario buscar en otras direcciones puesto que ya toda la matriz fue cubierta\n    Si se encontraron 2 o m\xE1s secuencias se determina que el DNA es de un mutante*/\n    const isMutantDNA = this.sequenceCounter >= 2 ? true : false;\n\n    const endTime = new Date().valueOf();\n    console.log(\"exec time: \", (endTime - initTime) / 1000);\n    return isMutantDNA;\n  }\n\n  private mapDnaMatrix(dna: string[]) {\n    this.dnaMatrixFull = new Array<Nucleotide[]>();\n    let line: string[] = [];\n\n    dna.forEach((value: string, j: number) => {\n      line = value.split(\"\");\n      const row: Nucleotide[] = new Array<Nucleotide>();\n      line.forEach((nucleotide, i) => {\n        row.push(new Nucleotide(nucleotide));\n      });\n      this.dnaMatrixFull.push(row);\n    });\n  }\n\n  public async saveDNASequence(dna: string, subjectType: string) {\n    try {\n      const dnaEntity = new DNASequencesEntity();\n      dnaEntity.sequence = dna;\n      dnaEntity.subjectType = subjectType;\n\n      await this.dnaSequenceService.saveDNASequence(dnaEntity);\n      await ConnectionDB.closeConnection();\n    } catch (e) {\n      console.log(\"saveDNASequence Error: \", e);\n      await ConnectionDB.closeConnection();\n      throw new Error(e);\n    }\n  }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"507b7daf6346e04d1f522ae24becfd8ae9bda481"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_22315r6cy8=function(){return actualCoverage;};}return actualCoverage;}cov_22315r6cy8();var __awaiter=(cov_22315r6cy8().s[0]++,(cov_22315r6cy8().b[0][0]++,this)&&(cov_22315r6cy8().b[0][1]++,this.__awaiter)||(cov_22315r6cy8().b[0][2]++,function(thisArg,_arguments,P,generator){cov_22315r6cy8().f[0]++;function adopt(value){cov_22315r6cy8().f[1]++;cov_22315r6cy8().s[1]++;return value instanceof P?(cov_22315r6cy8().b[1][0]++,value):(cov_22315r6cy8().b[1][1]++,new P(function(resolve){cov_22315r6cy8().f[2]++;cov_22315r6cy8().s[2]++;resolve(value);}));}cov_22315r6cy8().s[3]++;return new((cov_22315r6cy8().b[2][0]++,P)||(cov_22315r6cy8().b[2][1]++,P=Promise))(function(resolve,reject){cov_22315r6cy8().f[3]++;function fulfilled(value){cov_22315r6cy8().f[4]++;cov_22315r6cy8().s[4]++;try{cov_22315r6cy8().s[5]++;step(generator.next(value));}catch(e){cov_22315r6cy8().s[6]++;reject(e);}}function rejected(value){cov_22315r6cy8().f[5]++;cov_22315r6cy8().s[7]++;try{cov_22315r6cy8().s[8]++;step(generator["throw"](value));}catch(e){cov_22315r6cy8().s[9]++;reject(e);}}function step(result){cov_22315r6cy8().f[6]++;cov_22315r6cy8().s[10]++;result.done?(cov_22315r6cy8().b[3][0]++,resolve(result.value)):(cov_22315r6cy8().b[3][1]++,adopt(result.value).then(fulfilled,rejected));}cov_22315r6cy8().s[11]++;step((generator=generator.apply(thisArg,(cov_22315r6cy8().b[4][0]++,_arguments)||(cov_22315r6cy8().b[4][1]++,[]))).next());});}));cov_22315r6cy8().s[12]++;Object.defineProperty(exports,"__esModule",{value:true});cov_22315r6cy8().s[13]++;exports.DNAChecker=void 0;const nucleotide_model_1=(cov_22315r6cy8().s[14]++,require("../models/nucleotide.model"));const context_1=(cov_22315r6cy8().s[15]++,require("./searching-strategies/context"));const search_right_strategy_1=(cov_22315r6cy8().s[16]++,require("./searching-strategies/concrete-strategies/search-right-strategy"));const search_rigth_down_strategy_1=(cov_22315r6cy8().s[17]++,require("./searching-strategies/concrete-strategies/search-rigth-down-strategy"));const search_down_strategy_1=(cov_22315r6cy8().s[18]++,require("./searching-strategies/concrete-strategies/search-down-strategy"));const search_left_down_strategy_1=(cov_22315r6cy8().s[19]++,require("./searching-strategies/concrete-strategies/search-left-down-strategy"));const sequence_entity_1=(cov_22315r6cy8().s[20]++,require("../../core/entities/sequence.entity"));const dna_sequence_service_1=(cov_22315r6cy8().s[21]++,require("../services/dna_sequence.service"));const db_service_1=(cov_22315r6cy8().s[22]++,require("../../core/services/db/db.service"));class DNAChecker{constructor(){cov_22315r6cy8().f[7]++;cov_22315r6cy8().s[23]++;this.dnaMatrixFull=[];cov_22315r6cy8().s[24]++;this.sequenceCounter=0;cov_22315r6cy8().s[25]++;this.dnaSequenceService=new dna_sequence_service_1.DnaSequenceService();}isMutant(dna){cov_22315r6cy8().f[8]++;cov_22315r6cy8().s[26]++;return __awaiter(this,void 0,void 0,function*(){cov_22315r6cy8().f[9]++;const size=(cov_22315r6cy8().s[27]++,dna.length);const initTime=(cov_22315r6cy8().s[28]++,new Date().valueOf());// Mapeamos el array de entrada en un array 2D para hacer las busquedas en profundidad
cov_22315r6cy8().s[29]++;this.mapDnaMatrix(dna);// Verificar secuencia de ADN
cov_22315r6cy8().s[30]++;this.context=new context_1.SearchContext(size);cov_22315r6cy8().s[31]++;for(let i=(cov_22315r6cy8().s[32]++,0);i<size;i++){cov_22315r6cy8().s[33]++;for(let j=(cov_22315r6cy8().s[34]++,0);j<size;j++){cov_22315r6cy8().s[35]++;/*Realizar comparación con los nucleotidos de la horizontal a la derecha usando la estrategia de
                    busqueda en profundidad, si encuentra una secuencia aumenta el contador de secuencias*/this.context.setStrategy(new search_right_strategy_1.SearchRightStrategy());cov_22315r6cy8().s[36]++;this.sequenceCounter=this.context.search(i,j,this.dnaMatrixFull)?(cov_22315r6cy8().b[5][0]++,this.sequenceCounter+1):(cov_22315r6cy8().b[5][1]++,this.sequenceCounter);/*Realizar comparación con los nucleotidos de la diagonal derecha hacia abajo usando la
                    estrategia de busqueda en profundidad, si encuentra una secuencia aumenta el contador de
                    secuencias*/cov_22315r6cy8().s[37]++;this.context.setStrategy(new search_rigth_down_strategy_1.SearchRightDownStrategy());cov_22315r6cy8().s[38]++;this.sequenceCounter=this.context.search(i,j,this.dnaMatrixFull)?(cov_22315r6cy8().b[6][0]++,this.sequenceCounter+1):(cov_22315r6cy8().b[6][1]++,this.sequenceCounter);/*Realizar comparación con los nucleotidos de la vertical hacia abajo usando la estrategia de
                    busqueda en profundidad, si encuentra una secuencia aumenta el contador de secuencias*/cov_22315r6cy8().s[39]++;this.context.setStrategy(new search_down_strategy_1.SearchDownStrategy());cov_22315r6cy8().s[40]++;this.sequenceCounter=this.context.search(i,j,this.dnaMatrixFull)?(cov_22315r6cy8().b[7][0]++,this.sequenceCounter+1):(cov_22315r6cy8().b[7][1]++,this.sequenceCounter);/*Realizar comparación con los nucleotidos de la diagonal izquierda hacia abajo usando la
                    estrategia de busqueda en profundidad, si encuentra una secuencia aumenta el contador de
                    secuencias*/cov_22315r6cy8().s[41]++;this.context.setStrategy(new search_left_down_strategy_1.SearchLeftDownStrategy());cov_22315r6cy8().s[42]++;this.sequenceCounter=this.context.search(i,j,this.dnaMatrixFull)?(cov_22315r6cy8().b[8][0]++,this.sequenceCounter+1):(cov_22315r6cy8().b[8][1]++,this.sequenceCounter);}}/*no es necesario buscar en otras direcciones puesto que ya toda la matriz fue cubierta
            Si se encontraron 2 o más secuencias se determina que el DNA es de un mutante*/const isMutantDNA=(cov_22315r6cy8().s[43]++,this.sequenceCounter>=2?(cov_22315r6cy8().b[9][0]++,true):(cov_22315r6cy8().b[9][1]++,false));const endTime=(cov_22315r6cy8().s[44]++,new Date().valueOf());cov_22315r6cy8().s[45]++;console.log("exec time: ",(endTime-initTime)/1000);cov_22315r6cy8().s[46]++;return isMutantDNA;});}mapDnaMatrix(dna){cov_22315r6cy8().f[10]++;cov_22315r6cy8().s[47]++;this.dnaMatrixFull=new Array();let line=(cov_22315r6cy8().s[48]++,[]);cov_22315r6cy8().s[49]++;dna.forEach((value,j)=>{cov_22315r6cy8().f[11]++;cov_22315r6cy8().s[50]++;line=value.split("");const row=(cov_22315r6cy8().s[51]++,new Array());cov_22315r6cy8().s[52]++;line.forEach((nucleotide,i)=>{cov_22315r6cy8().f[12]++;cov_22315r6cy8().s[53]++;row.push(new nucleotide_model_1.Nucleotide(nucleotide));});cov_22315r6cy8().s[54]++;this.dnaMatrixFull.push(row);});}saveDNASequence(dna,subjectType){cov_22315r6cy8().f[13]++;cov_22315r6cy8().s[55]++;return __awaiter(this,void 0,void 0,function*(){cov_22315r6cy8().f[14]++;cov_22315r6cy8().s[56]++;try{const dnaEntity=(cov_22315r6cy8().s[57]++,new sequence_entity_1.DNASequencesEntity());cov_22315r6cy8().s[58]++;dnaEntity.sequence=dna;cov_22315r6cy8().s[59]++;dnaEntity.subjectType=subjectType;cov_22315r6cy8().s[60]++;yield this.dnaSequenceService.saveDNASequence(dnaEntity);cov_22315r6cy8().s[61]++;yield db_service_1.ConnectionDB.closeConnection();}catch(e){cov_22315r6cy8().s[62]++;console.log("saveDNASequence Error: ",e);cov_22315r6cy8().s[63]++;yield db_service_1.ConnectionDB.closeConnection();cov_22315r6cy8().s[64]++;throw new Error(e);}});}}cov_22315r6cy8().s[65]++;exports.DNAChecker=DNAChecker;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL2Ryb2RyMjUvRGVza3RvcC9NdXRhbnRETkFDaGVja2VyL3NyYy9tb2R1bGVzL2RuYS1jaGVja2VyL2NvbnRyb2xsZXJzL2RuYS1jaGVja2VyLmNvbnRyb2xsZXIudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9kcm9kcjI1L0Rlc2t0b3AvTXV0YW50RE5BQ2hlY2tlci9zcmMvbW9kdWxlcy9kbmEtY2hlY2tlci9jb250cm9sbGVycy9kbmEtY2hlY2tlci5jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLGlFQUF3RDtBQUN4RCw0REFBK0Q7QUFDL0QsNEdBQXVHO0FBQ3ZHLHNIQUFnSDtBQUNoSCwwR0FBcUc7QUFDckcsb0hBQThHO0FBQzlHLHlFQUF5RTtBQUN6RSwyRUFBc0U7QUFDdEUsa0VBQWlFO0FBRWpFLE1BQWEsVUFBVTtJQU9yQjtRQU5BLGtCQUFhLEdBQW1CLEVBQUUsQ0FBQztRQUMzQixvQkFBZSxHQUFXLENBQUMsQ0FBQztRQU1sQyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSx5Q0FBa0IsRUFBRSxDQUFDO0lBQ3JELENBQUM7SUFFWSxRQUFRLENBQUMsR0FBYTs7WUFDakMsTUFBTSxJQUFJLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQztZQUN4QixNQUFNLFFBQVEsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBRXRDLHNGQUFzRjtZQUN0RixJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRXZCLDZCQUE2QjtZQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksdUJBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN2QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUM3QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLENB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QUFXLEVBQUUsV0FBbUI7O1lBQzNELElBQUk7Z0JBQ0YsTUFBTSxTQUFTLEdBQUcsSUFBSSxvQ0FBa0IsRUFBRSxDQUFDO2dCQUMzQyxTQUFTLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztnQkFDekIsU0FBUyxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7Z0JBRXBDLE1BQU0sSUFBSSxDQUFDLGtCQUFrQixDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQkFDekQsTUFBTSx5QkFBWSxDQUFDLGVBQWUsRUFBRSxDQUFDO2FBQ3RDO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ1YsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDMUMsTUFBTSx5QkFBWSxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUNyQyxNQUFNLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3BCO1FBQ0gsQ0FBQztLQUFBO0NBQ0Y7QUEzRkQsZ0NBMkZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTnVjbGVvdGlkZSB9IGZyb20gXCIuLi9tb2RlbHMvbnVjbGVvdGlkZS5tb2RlbFwiO1xuaW1wb3J0IHsgU2VhcmNoQ29udGV4dCB9IGZyb20gXCIuL3NlYXJjaGluZy1zdHJhdGVnaWVzL2NvbnRleHRcIjtcbmltcG9ydCB7IFNlYXJjaFJpZ2h0U3RyYXRlZ3kgfSBmcm9tIFwiLi9zZWFyY2hpbmctc3RyYXRlZ2llcy9jb25jcmV0ZS1zdHJhdGVnaWVzL3NlYXJjaC1yaWdodC1zdHJhdGVneVwiO1xuaW1wb3J0IHsgU2VhcmNoUmlnaHREb3duU3RyYXRlZ3kgfSBmcm9tIFwiLi9zZWFyY2hpbmctc3RyYXRlZ2llcy9jb25jcmV0ZS1zdHJhdGVnaWVzL3NlYXJjaC1yaWd0aC1kb3duLXN0cmF0ZWd5XCI7XG5pbXBvcnQgeyBTZWFyY2hEb3duU3RyYXRlZ3kgfSBmcm9tIFwiLi9zZWFyY2hpbmctc3RyYXRlZ2llcy9jb25jcmV0ZS1zdHJhdGVnaWVzL3NlYXJjaC1kb3duLXN0cmF0ZWd5XCI7XG5pbXBvcnQgeyBTZWFyY2hMZWZ0RG93blN0cmF0ZWd5IH0gZnJvbSBcIi4vc2VhcmNoaW5nLXN0cmF0ZWdpZXMvY29uY3JldGUtc3RyYXRlZ2llcy9zZWFyY2gtbGVmdC1kb3duLXN0cmF0ZWd5XCI7XG5pbXBvcnQgeyBETkFTZXF1ZW5jZXNFbnRpdHkgfSBmcm9tIFwiLi4vLi4vY29yZS9lbnRpdGllcy9zZXF1ZW5jZS5lbnRpdHlcIjtcbmltcG9ydCB7IERuYVNlcXVlbmNlU2VydmljZSB9IGZyb20gXCIuLi9zZXJ2aWNlcy9kbmFfc2VxdWVuY2Uuc2VydmljZVwiO1xuaW1wb3J0IHsgQ29ubmVjdGlvbkRCIH0gZnJvbSBcIi4uLy4uL2NvcmUvc2VydmljZXMvZGIvZGIuc2VydmljZVwiO1xuXG5leHBvcnQgY2xhc3MgRE5BQ2hlY2tlciB7XG4gIGRuYU1hdHJpeEZ1bGw6IE51Y2xlb3RpZGVbXVtdID0gW107XG4gIHByaXZhdGUgc2VxdWVuY2VDb3VudGVyOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGNvbnRleHQ6IFNlYXJjaENvbnRleHQ7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBkbmFTZXF1ZW5jZVNlcnZpY2U6IERuYVNlcXVlbmNlU2VydmljZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmRuYVNlcXVlbmNlU2VydmljZSA9IG5ldyBEbmFTZXF1ZW5jZVNlcnZpY2UoKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBpc011dGFudChkbmE6IHN0cmluZ1tdKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3Qgc2l6ZSA9IGRuYS5sZW5ndGg7XG4gICAgY29uc3QgaW5pdFRpbWUgPSBuZXcgRGF0ZSgpLnZhbHVlT2YoKTtcblxuICAgIC8vIE1hcGVhbW9zIGVsIGFycmF5IGRlIGVudHJhZGEgZW4gdW4gYXJyYXkgMkQgcGFyYSBoYWNlciBsYXMgYnVzcXVlZGFzIGVuIHByb2Z1bmRpZGFkXG4gICAgdGhpcy5tYXBEbmFNYXRyaXgoZG5hKTtcblxuICAgIC8vIFZlcmlmaWNhciBzZWN1ZW5jaWEgZGUgQUROXG4gICAgdGhpcy5jb250ZXh0ID0gbmV3IFNlYXJjaENvbnRleHQoc2l6ZSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2l6ZTsgaisrKSB7XG4gICAgICAgIC8qUmVhbGl6YXIgY29tcGFyYWNpw7NuIGNvbiBsb3MgbnVjbGVvdGlkb3MgZGUgbGEgaG9yaXpvbnRhbCBhIGxhIGRlcmVjaGEgdXNhbmRvIGxhIGVzdHJhdGVnaWEgZGVcbiAgICAgICAgYnVzcXVlZGEgZW4gcHJvZnVuZGlkYWQsIHNpIGVuY3VlbnRyYSB1bmEgc2VjdWVuY2lhIGF1bWVudGEgZWwgY29udGFkb3IgZGUgc2VjdWVuY2lhcyovXG4gICAgICAgIHRoaXMuY29udGV4dC5zZXRTdHJhdGVneShuZXcgU2VhcmNoUmlnaHRTdHJhdGVneSgpKTtcbiAgICAgICAgdGhpcy5zZXF1ZW5jZUNvdW50ZXIgPSB0aGlzLmNvbnRleHQuc2VhcmNoKGksIGosIHRoaXMuZG5hTWF0cml4RnVsbClcbiAgICAgICAgICA/IHRoaXMuc2VxdWVuY2VDb3VudGVyICsgMVxuICAgICAgICAgIDogdGhpcy5zZXF1ZW5jZUNvdW50ZXI7XG5cbiAgICAgICAgLypSZWFsaXphciBjb21wYXJhY2nDs24gY29uIGxvcyBudWNsZW90aWRvcyBkZSBsYSBkaWFnb25hbCBkZXJlY2hhIGhhY2lhIGFiYWpvIHVzYW5kbyBsYVxuICAgICAgICBlc3RyYXRlZ2lhIGRlIGJ1c3F1ZWRhIGVuIHByb2Z1bmRpZGFkLCBzaSBlbmN1ZW50cmEgdW5hIHNlY3VlbmNpYSBhdW1lbnRhIGVsIGNvbnRhZG9yIGRlXG4gICAgICAgIHNlY3VlbmNpYXMqL1xuICAgICAgICB0aGlzLmNvbnRleHQuc2V0U3RyYXRlZ3kobmV3IFNlYXJjaFJpZ2h0RG93blN0cmF0ZWd5KCkpO1xuICAgICAgICB0aGlzLnNlcXVlbmNlQ291bnRlciA9IHRoaXMuY29udGV4dC5zZWFyY2goaSwgaiwgdGhpcy5kbmFNYXRyaXhGdWxsKVxuICAgICAgICAgID8gdGhpcy5zZXF1ZW5jZUNvdW50ZXIgKyAxXG4gICAgICAgICAgOiB0aGlzLnNlcXVlbmNlQ291bnRlcjtcblxuICAgICAgICAvKlJlYWxpemFyIGNvbXBhcmFjacOzbiBjb24gbG9zIG51Y2xlb3RpZG9zIGRlIGxhIHZlcnRpY2FsIGhhY2lhIGFiYWpvIHVzYW5kbyBsYSBlc3RyYXRlZ2lhIGRlXG4gICAgICAgIGJ1c3F1ZWRhIGVuIHByb2Z1bmRpZGFkLCBzaSBlbmN1ZW50cmEgdW5hIHNlY3VlbmNpYSBhdW1lbnRhIGVsIGNvbnRhZG9yIGRlIHNlY3VlbmNpYXMqL1xuICAgICAgICB0aGlzLmNvbnRleHQuc2V0U3RyYXRlZ3kobmV3IFNlYXJjaERvd25TdHJhdGVneSgpKTtcbiAgICAgICAgdGhpcy5zZXF1ZW5jZUNvdW50ZXIgPSB0aGlzLmNvbnRleHQuc2VhcmNoKGksIGosIHRoaXMuZG5hTWF0cml4RnVsbClcbiAgICAgICAgICA/IHRoaXMuc2VxdWVuY2VDb3VudGVyICsgMVxuICAgICAgICAgIDogdGhpcy5zZXF1ZW5jZUNvdW50ZXI7XG5cbiAgICAgICAgLypSZWFsaXphciBjb21wYXJhY2nDs24gY29uIGxvcyBudWNsZW90aWRvcyBkZSBsYSBkaWFnb25hbCBpenF1aWVyZGEgaGFjaWEgYWJham8gdXNhbmRvIGxhXG4gICAgICAgIGVzdHJhdGVnaWEgZGUgYnVzcXVlZGEgZW4gcHJvZnVuZGlkYWQsIHNpIGVuY3VlbnRyYSB1bmEgc2VjdWVuY2lhIGF1bWVudGEgZWwgY29udGFkb3IgZGVcbiAgICAgICAgc2VjdWVuY2lhcyovXG4gICAgICAgIHRoaXMuY29udGV4dC5zZXRTdHJhdGVneShuZXcgU2VhcmNoTGVmdERvd25TdHJhdGVneSgpKTtcbiAgICAgICAgdGhpcy5zZXF1ZW5jZUNvdW50ZXIgPSB0aGlzLmNvbnRleHQuc2VhcmNoKGksIGosIHRoaXMuZG5hTWF0cml4RnVsbClcbiAgICAgICAgICA/IHRoaXMuc2VxdWVuY2VDb3VudGVyICsgMVxuICAgICAgICAgIDogdGhpcy5zZXF1ZW5jZUNvdW50ZXI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLypubyBlcyBuZWNlc2FyaW8gYnVzY2FyIGVuIG90cmFzIGRpcmVjY2lvbmVzIHB1ZXN0byBxdWUgeWEgdG9kYSBsYSBtYXRyaXogZnVlIGN1YmllcnRhXG4gICAgU2kgc2UgZW5jb250cmFyb24gMiBvIG3DoXMgc2VjdWVuY2lhcyBzZSBkZXRlcm1pbmEgcXVlIGVsIEROQSBlcyBkZSB1biBtdXRhbnRlKi9cbiAgICBjb25zdCBpc011dGFudEROQSA9IHRoaXMuc2VxdWVuY2VDb3VudGVyID49IDIgPyB0cnVlIDogZmFsc2U7XG5cbiAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoKS52YWx1ZU9mKCk7XG4gICAgY29uc29sZS5sb2coXCJleGVjIHRpbWU6IFwiLCAoZW5kVGltZSAtIGluaXRUaW1lKSAvIDEwMDApO1xuICAgIHJldHVybiBpc011dGFudEROQTtcbiAgfVxuXG4gIHByaXZhdGUgbWFwRG5hTWF0cml4KGRuYTogc3RyaW5nW10pIHtcbiAgICB0aGlzLmRuYU1hdHJpeEZ1bGwgPSBuZXcgQXJyYXk8TnVjbGVvdGlkZVtdPigpO1xuICAgIGxldCBsaW5lOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZG5hLmZvckVhY2goKHZhbHVlOiBzdHJpbmcsIGo6IG51bWJlcikgPT4ge1xuICAgICAgbGluZSA9IHZhbHVlLnNwbGl0KFwiXCIpO1xuICAgICAgY29uc3Qgcm93OiBOdWNsZW90aWRlW10gPSBuZXcgQXJyYXk8TnVjbGVvdGlkZT4oKTtcbiAgICAgIGxpbmUuZm9yRWFjaCgobnVjbGVvdGlkZSwgaSkgPT4ge1xuICAgICAgICByb3cucHVzaChuZXcgTnVjbGVvdGlkZShudWNsZW90aWRlKSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZG5hTWF0cml4RnVsbC5wdXNoKHJvdyk7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2F2ZUROQVNlcXVlbmNlKGRuYTogc3RyaW5nLCBzdWJqZWN0VHlwZTogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRuYUVudGl0eSA9IG5ldyBETkFTZXF1ZW5jZXNFbnRpdHkoKTtcbiAgICAgIGRuYUVudGl0eS5zZXF1ZW5jZSA9IGRuYTtcbiAgICAgIGRuYUVudGl0eS5zdWJqZWN0VHlwZSA9IHN1YmplY3RUeXBlO1xuXG4gICAgICBhd2FpdCB0aGlzLmRuYVNlcXVlbmNlU2VydmljZS5zYXZlRE5BU2VxdWVuY2UoZG5hRW50aXR5KTtcbiAgICAgIGF3YWl0IENvbm5lY3Rpb25EQi5jbG9zZUNvbm5lY3Rpb24oKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmxvZyhcInNhdmVETkFTZXF1ZW5jZSBFcnJvcjogXCIsIGUpO1xuICAgICAgYXdhaXQgQ29ubmVjdGlvbkRCLmNsb3NlQ29ubmVjdGlvbigpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGUpO1xuICAgIH1cbiAgfVxufVxuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9kcm9kcjI1L0Rlc2t0b3AvTXV0YW50RE5BQ2hlY2tlci9zcmMvbW9kdWxlcy9kbmEtY2hlY2tlci9jb250cm9sbGVycy9kbmEtY2hlY2tlci5jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIra2hCQUdBOzBoREFIQSxLQUFBLENBQUEsa0JBQUEsMkJBQUEsT0FBQSxDQUFBLDRCQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxTQUFBLDJCQUFBLE9BQUEsQ0FBQSxnQ0FBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsdUJBQUEsMkJBQUEsT0FBQSxDQUFBLGtFQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSw0QkFBQSwyQkFBQSxPQUFBLENBQUEsdUVBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLHNCQUFBLDJCQUFBLE9BQUEsQ0FBQSxpRUFBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsMkJBQUEsMkJBQUEsT0FBQSxDQUFBLHNFQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxpQkFBQSwyQkFBQSxPQUFBLENBQUEscUNBQUEsQ0FBQSxDQUFBLENBQ0EsS0FBQSxDQUFBLHNCQUFBLDJCQUFBLE9BQUEsQ0FBQSxrQ0FBQSxDQUFBLENBQUEsQ0FDQSxLQUFBLENBQUEsWUFBQSwyQkFBQSxPQUFBLENBQUEsbUNBQUEsQ0FBQSxDQUFBLENBRUEsS0FBYSxDQUFBLFVBQVUsQ0FPckIsV0FBQSxFQUFBLGtEQU5BLEtBQUEsYUFBQSxDQUFnQyxFQUFoQyxDQU1BLHlCQUxRLEtBQUEsZUFBQSxDQUEwQixDQUExQixDQUtSLHlCQUNFLEtBQUssa0JBQUwsQ0FBMEIsR0FBSSxDQUFBLHNCQUFBLENBQUEsa0JBQUosRUFBMUIsQ0FDRCxDQUVZLFFBQVEsQ0FBQyxHQUFELENBQWMsa0Qsd0VBQ2pDLEtBQU0sQ0FBQSxJQUFJLDJCQUFHLEdBQUcsQ0FBQyxNQUFQLENBQVYsQ0FDQSxLQUFNLENBQUEsUUFBUSwyQkFB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RCxDQUFhLENBQWIsR0FBa0IsbURBQzdCLEdBQUcsQ0FBQyxJQUFKLENBQVMsR0FBSSxDQUFBLGtCQUFBLENBQUEsVUFBSixDQUFlLFVBQWYsQ0FBVCxFQUNELENBRkQsRUFIdUMseUJBTXZDLEtBQUssYUFBTCxDQUFtQixJQUFuQixDQUF3QixHQUF4QixFQUNELENBUEQsRUFRRCxDQUVZLGVBQWUsQ0FBQyxHQUFELENBQWMsV0FBZCxDQUFpQyxtRCxrR0FDM0QsR0FBSSxDQUNGLEtBQU0sQ0FBQSxTQUFTLDJCQUFHLEdBQUksQ0FBQSxpQkFBQSxDQUFBLGtCQUFKLEVBQUgsQ0FBZixDQURFLHlCQUVGLFNBQVMsQ0FBQyxRQUFWLENBQXFCLEdBQXJCLENBRkUseUJBR0YsU0FBUyxDQUFDLFdBQVYsQ0FBd0IsV0FBeEIsQ0FIRSx5QkFLRixLQUFNLE1BQUssa0JBQUwsQ0FBd0IsZUFBeEIsQ0FBd0MsU0FBeEMsQ0FBTixDQUxFLHlCQU1GLEtBQU0sQ0FBQSxZQUFBLENBQUEsWUFBQSxDQUFhLGVBQWIsRUFBTixDQUNELENBQUMsTUFBTyxDQUFQLENBQVUsMEJBQ1YsT0FBTyxDQUFDLEdBQVIsQ0FBWSx5QkFBWixDQUF1QyxDQUF2QyxFQURVLHlCQUVWLEtBQU0sQ0FBQSxZQUFBLENBQUEsWUFBQSxDQUFhLGVBQWIsRUFBTixDQUZVLHlCQUdWLEtBQU0sSUFBSSxDQUFBLEtBQUosQ0FBVSxDQUFWLENBQU4sQ0FDRCxDQUNGLEMsRUFBQSxDQTFGb0IsQyx5QkFBdkIsT0FBQSxDQUFBLFVBQUEsQ0FBQSxVQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOdWNsZW90aWRlIH0gZnJvbSBcIi4uL21vZGVscy9udWNsZW90aWRlLm1vZGVsXCI7XG5pbXBvcnQgeyBTZWFyY2hDb250ZXh0IH0gZnJvbSBcIi4vc2VhcmNoaW5nLXN0cmF0ZWdpZXMvY29udGV4dFwiO1xuaW1wb3J0IHsgU2VhcmNoUmlnaHRTdHJhdGVneSB9IGZyb20gXCIuL3NlYXJjaGluZy1zdHJhdGVnaWVzL2NvbmNyZXRlLXN0cmF0ZWdpZXMvc2VhcmNoLXJpZ2h0LXN0cmF0ZWd5XCI7XG5pbXBvcnQgeyBTZWFyY2hSaWdodERvd25TdHJhdGVneSB9IGZyb20gXCIuL3NlYXJjaGluZy1zdHJhdGVnaWVzL2NvbmNyZXRlLXN0cmF0ZWdpZXMvc2VhcmNoLXJpZ3RoLWRvd24tc3RyYXRlZ3lcIjtcbmltcG9ydCB7IFNlYXJjaERvd25TdHJhdGVneSB9IGZyb20gXCIuL3NlYXJjaGluZy1zdHJhdGVnaWVzL2NvbmNyZXRlLXN0cmF0ZWdpZXMvc2VhcmNoLWRvd24tc3RyYXRlZ3lcIjtcbmltcG9ydCB7IFNlYXJjaExlZnREb3duU3RyYXRlZ3kgfSBmcm9tIFwiLi9zZWFyY2hpbmctc3RyYXRlZ2llcy9jb25jcmV0ZS1zdHJhdGVnaWVzL3NlYXJjaC1sZWZ0LWRvd24tc3RyYXRlZ3lcIjtcbmltcG9ydCB7IEROQVNlcXVlbmNlc0VudGl0eSB9IGZyb20gXCIuLi8uLi9jb3JlL2VudGl0aWVzL3NlcXVlbmNlLmVudGl0eVwiO1xuaW1wb3J0IHsgRG5hU2VxdWVuY2VTZXJ2aWNlIH0gZnJvbSBcIi4uL3NlcnZpY2VzL2RuYV9zZXF1ZW5jZS5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uREIgfSBmcm9tIFwiLi4vLi4vY29yZS9zZXJ2aWNlcy9kYi9kYi5zZXJ2aWNlXCI7XG5cbmV4cG9ydCBjbGFzcyBETkFDaGVja2VyIHtcbiAgZG5hTWF0cml4RnVsbDogTnVjbGVvdGlkZVtdW10gPSBbXTtcbiAgcHJpdmF0ZSBzZXF1ZW5jZUNvdW50ZXI6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgY29udGV4dDogU2VhcmNoQ29udGV4dDtcblxuICBwcml2YXRlIHJlYWRvbmx5IGRuYVNlcXVlbmNlU2VydmljZTogRG5hU2VxdWVuY2VTZXJ2aWNlO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZG5hU2VxdWVuY2VTZXJ2aWNlID0gbmV3IERuYVNlcXVlbmNlU2VydmljZSgpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGlzTXV0YW50KGRuYTogc3RyaW5nW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBzaXplID0gZG5hLmxlbmd0aDtcbiAgICBjb25zdCBpbml0VGltZSA9IG5ldyBEYXRlKCkudmFsdWVPZigpO1xuXG4gICAgLy8gTWFwZWFtb3MgZWwgYXJyYXkgZGUgZW50cmFkYSBlbiB1biBhcnJheSAyRCBwYXJhIGhhY2VyIGxhcyBidXNxdWVkYXMgZW4gcHJvZnVuZGlkYWRcbiAgICB0aGlzLm1hcERuYU1hdHJpeChkbmEpO1xuXG4gICAgLy8gVmVyaWZpY2FyIHNlY3VlbmNpYSBkZSBBRE5cbiAgICB0aGlzLmNvbnRleHQgPSBuZXcgU2VhcmNoQ29udGV4dChzaXplKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaXplOyBqKyspIHtcbiAgICAgICAgLypSZWFsaXphciBjb21wYXJhY2nDs24gY29uIGxvcyBudWNsZW90aWRvcyBkZSBsYSBob3Jpem9udGFsIGEgbGEgZGVyZWNoYSB1c2FuZG8gbGEgZXN0cmF0ZWdpYSBkZVxuICAgICAgICBidXNxdWVkYSBlbiBwcm9mdW5kaWRhZCwgc2kgZW5jdWVudHJhIHVuYSBzZWN1ZW5jaWEgYXVtZW50YSBlbCBjb250YWRvciBkZSBzZWN1ZW5jaWFzKi9cbiAgICAgICAgdGhpcy5jb250ZXh0LnNldFN0cmF0ZWd5KG5ldyBTZWFyY2hSaWdodFN0cmF0ZWd5KCkpO1xuICAgICAgICB0aGlzLnNlcXVlbmNlQ291bnRlciA9IHRoaXMuY29udGV4dC5zZWFyY2goaSwgaiwgdGhpcy5kbmFNYXRyaXhGdWxsKVxuICAgICAgICAgID8gdGhpcy5zZXF1ZW5jZUNvdW50ZXIgKyAxXG4gICAgICAgICAgOiB0aGlzLnNlcXVlbmNlQ291bnRlcjtcblxuICAgICAgICAvKlJlYWxpemFyIGNvbXBhcmFjacOzbiBjb24gbG9zIG51Y2xlb3RpZG9zIGRlIGxhIGRpYWdvbmFsIGRlcmVjaGEgaGFjaWEgYWJham8gdXNhbmRvIGxhXG4gICAgICAgIGVzdHJhdGVnaWEgZGUgYnVzcXVlZGEgZW4gcHJvZnVuZGlkYWQsIHNpIGVuY3VlbnRyYSB1bmEgc2VjdWVuY2lhIGF1bWVudGEgZWwgY29udGFkb3IgZGVcbiAgICAgICAgc2VjdWVuY2lhcyovXG4gICAgICAgIHRoaXMuY29udGV4dC5zZXRTdHJhdGVneShuZXcgU2VhcmNoUmlnaHREb3duU3RyYXRlZ3koKSk7XG4gICAgICAgIHRoaXMuc2VxdWVuY2VDb3VudGVyID0gdGhpcy5jb250ZXh0LnNlYXJjaChpLCBqLCB0aGlzLmRuYU1hdHJpeEZ1bGwpXG4gICAgICAgICAgPyB0aGlzLnNlcXVlbmNlQ291bnRlciArIDFcbiAgICAgICAgICA6IHRoaXMuc2VxdWVuY2VDb3VudGVyO1xuXG4gICAgICAgIC8qUmVhbGl6YXIgY29tcGFyYWNpw7NuIGNvbiBsb3MgbnVjbGVvdGlkb3MgZGUgbGEgdmVydGljYWwgaGFjaWEgYWJham8gdXNhbmRvIGxhIGVzdHJhdGVnaWEgZGVcbiAgICAgICAgYnVzcXVlZGEgZW4gcHJvZnVuZGlkYWQsIHNpIGVuY3VlbnRyYSB1bmEgc2VjdWVuY2lhIGF1bWVudGEgZWwgY29udGFkb3IgZGUgc2VjdWVuY2lhcyovXG4gICAgICAgIHRoaXMuY29udGV4dC5zZXRTdHJhdGVneShuZXcgU2VhcmNoRG93blN0cmF0ZWd5KCkpO1xuICAgICAgICB0aGlzLnNlcXVlbmNlQ291bnRlciA9IHRoaXMuY29udGV4dC5zZWFyY2goaSwgaiwgdGhpcy5kbmFNYXRyaXhGdWxsKVxuICAgICAgICAgID8gdGhpcy5zZXF1ZW5jZUNvdW50ZXIgKyAxXG4gICAgICAgICAgOiB0aGlzLnNlcXVlbmNlQ291bnRlcjtcblxuICAgICAgICAvKlJlYWxpemFyIGNvbXBhcmFjacOzbiBjb24gbG9zIG51Y2xlb3RpZG9zIGRlIGxhIGRpYWdvbmFsIGl6cXVpZXJkYSBoYWNpYSBhYmFqbyB1c2FuZG8gbGFcbiAgICAgICAgZXN0cmF0ZWdpYSBkZSBidXNxdWVkYSBlbiBwcm9mdW5kaWRhZCwgc2kgZW5jdWVudHJhIHVuYSBzZWN1ZW5jaWEgYXVtZW50YSBlbCBjb250YWRvciBkZVxuICAgICAgICBzZWN1ZW5jaWFzKi9cbiAgICAgICAgdGhpcy5jb250ZXh0LnNldFN0cmF0ZWd5KG5ldyBTZWFyY2hMZWZ0RG93blN0cmF0ZWd5KCkpO1xuICAgICAgICB0aGlzLnNlcXVlbmNlQ291bnRlciA9IHRoaXMuY29udGV4dC5zZWFyY2goaSwgaiwgdGhpcy5kbmFNYXRyaXhGdWxsKVxuICAgICAgICAgID8gdGhpcy5zZXF1ZW5jZUNvdW50ZXIgKyAxXG4gICAgICAgICAgOiB0aGlzLnNlcXVlbmNlQ291bnRlcjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKm5vIGVzIG5lY2VzYXJpbyBidXNjYXIgZW4gb3RyYXMgZGlyZWNjaW9uZXMgcHVlc3RvIHF1ZSB5YSB0b2RhIGxhIG1hdHJpeiBmdWUgY3ViaWVydGFcbiAgICBTaSBzZSBlbmNvbnRyYXJvbiAyIG8gbcOhcyBzZWN1ZW5jaWFzIHNlIGRldGVybWluYSBxdWUgZWwgRE5BIGVzIGRlIHVuIG11dGFudGUqL1xuICAgIGNvbnN0IGlzTXV0YW50RE5BID0gdGhpcy5zZXF1ZW5jZUNvdW50ZXIgPj0gMiA/IHRydWUgOiBmYWxzZTtcblxuICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpLnZhbHVlT2YoKTtcbiAgICBjb25zb2xlLmxvZyhcImV4ZWMgdGltZTogXCIsIChlbmRUaW1lIC0gaW5pdFRpbWUpIC8gMTAwMCk7XG4gICAgcmV0dXJuIGlzTXV0YW50RE5BO1xuICB9XG5cbiAgcHJpdmF0ZSBtYXBEbmFNYXRyaXgoZG5hOiBzdHJpbmdbXSkge1xuICAgIHRoaXMuZG5hTWF0cml4RnVsbCA9IG5ldyBBcnJheTxOdWNsZW90aWRlW10+KCk7XG4gICAgbGV0IGxpbmU6IHN0cmluZ1tdID0gW107XG5cbiAgICBkbmEuZm9yRWFjaCgodmFsdWU6IHN0cmluZywgajogbnVtYmVyKSA9PiB7XG4gICAgICBsaW5lID0gdmFsdWUuc3BsaXQoXCJcIik7XG4gICAgICBjb25zdCByb3c6IE51Y2xlb3RpZGVbXSA9IG5ldyBBcnJheTxOdWNsZW90aWRlPigpO1xuICAgICAgbGluZS5mb3JFYWNoKChudWNsZW90aWRlLCBpKSA9PiB7XG4gICAgICAgIHJvdy5wdXNoKG5ldyBOdWNsZW90aWRlKG51Y2xlb3RpZGUpKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5kbmFNYXRyaXhGdWxsLnB1c2gocm93KTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzYXZlRE5BU2VxdWVuY2UoZG5hOiBzdHJpbmcsIHN1YmplY3RUeXBlOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZG5hRW50aXR5ID0gbmV3IEROQVNlcXVlbmNlc0VudGl0eSgpO1xuICAgICAgZG5hRW50aXR5LnNlcXVlbmNlID0gZG5hO1xuICAgICAgZG5hRW50aXR5LnN1YmplY3RUeXBlID0gc3ViamVjdFR5cGU7XG5cbiAgICAgIGF3YWl0IHRoaXMuZG5hU2VxdWVuY2VTZXJ2aWNlLnNhdmVETkFTZXF1ZW5jZShkbmFFbnRpdHkpO1xuICAgICAgYXdhaXQgQ29ubmVjdGlvbkRCLmNsb3NlQ29ubmVjdGlvbigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwic2F2ZUROQVNlcXVlbmNlIEVycm9yOiBcIiwgZSk7XG4gICAgICBhd2FpdCBDb25uZWN0aW9uREIuY2xvc2VDb25uZWN0aW9uKCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZSk7XG4gICAgfVxuICB9XG59XG4iXX0=